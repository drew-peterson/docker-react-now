sudo: required
language: node_js
services:
  - docker
node_js:
  - "node"
cache: yarn
before_install:
  # - docker build -t weeznog/docker-react-now -f ./client/Dockerfile.dev ./client
  - yarn add now
script:
  - echo "skipping tests"
  # - docker run weeznog/docker-react-now yarn test -- --coverage
# before_deploy: yarn add now
deploy:
  - provider: script
    script: now ./client --docker --public --token $NOW_TOKEN && now alias -A ./client/now.dev.json --token $NOW_TOKEN
    skip_cleanup: true
    on:
      all_branches: true
      master: false
  - provider: script
    # script: now ./client --docker --public --token $NOW_TOKEN && now alias -A ./client/now.json --token $NOW_TOKEN && now rm docker-react-now --safe --yes --token $NOW_TOKEN
    script: now ./client --docker --public --token $NOW_TOKEN && now alias -A ./client/now.json --token $NOW_TOKEN
    skip_cleanup: true
    on:
      branch: master
notifications:
  email: false
